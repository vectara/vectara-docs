---
id: update-instruction
title: "Update instruction"
description: "Update an existing instruction's template, metadata, and configuration. Updated templates may include Velocity variables such as `$tools` or metadata references. Each update creates a new version, allowing agents to continue using existing versions until explicitly changed."
sidebar_label: "Update instruction"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "patch api-method"
info_path: docs/rest-api/vectara-rest-api-v-2
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Update instruction"}
>
</Heading>

<MethodEndpoint
  method={"patch"}
  path={"/v2/instructions/{instruction_id}"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Update an existing instruction's template, metadata, and configuration. Updated templates may include Velocity variables such as `\$tools` or metadata references. Each update creates a new version, allowing agents to continue using existing versions until explicitly changed.

::info Version Management
Agents referencing a specific version continue to use it until updated. Agents without a pinned version always use the latest.
:::

## Disable an instruction

This endpoint can also be used to disable an instruction without deleting it.

:::warning
Disabling an instruction prevents it from being added to new agents, but agents already using it continue to operate normally.
:::


<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"in":"header","name":"Request-Timeout","description":"The API will make a best effort to complete the request in the specified seconds or time out.","schema":{"type":"integer","minimum":1},"required":false},{"in":"header","name":"Request-Timeout-Millis","description":"The API will make a best effort to complete the request in the specified milliseconds or time out.","schema":{"type":"integer","minimum":1}},{"in":"path","name":"instruction_id","description":"The unique identifier of the instruction to update.","required":true,"schema":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"required":true,"content":{"application/json":{"schema":{"description":"Request to update an instruction. Currently only initial instructions are supported.","discriminator":{"propertyName":"type","mapping":{"initial":{"description":"Request object for updating an existing initial instruction.","type":"object","properties":{"type":{"description":"The type of instruction to update.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string","example":"Enhanced initial context and guidelines for customer support interactions"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true,"example":{"version":"1.1.0","author":"support-team","last_reviewed":"2024-01-15"}},"enabled":{"description":"Whether the instruction is enabled.","type":"boolean","example":true}},"required":["type"],"x-vectaraParents":["UpdateInstructionRequest"],"title":"UpdateInitialInstructionRequest"}}},"oneOf":[{"description":"Request object for updating an existing initial instruction.","type":"object","properties":{"type":{"description":"The type of instruction to update.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string","example":"Enhanced initial context and guidelines for customer support interactions"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true,"example":{"version":"1.1.0","author":"support-team","last_reviewed":"2024-01-15"}},"enabled":{"description":"Whether the instruction is enabled.","type":"boolean","example":true}},"required":["type"],"x-vectaraParents":["UpdateInstructionRequest"],"title":"UpdateInitialInstructionRequest"}],"title":"UpdateInstructionRequest"}}}}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The instruction has been updated successfully.","content":{"application/json":{"schema":{"description":"An instruction that guides agent behavior.","discriminator":{"propertyName":"type","mapping":{"initial":{"description":"An initial instruction that provides guidance to the agent before user messages.","type":"object","properties":{"id":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"},"type":{"description":"The type of instruction.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"version":{"description":"The version identifier for this instruction. This is automatically incremented when the instruction is updated.","type":"integer","minimum":1,"example":1},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true},"enabled":{"description":"Whether the instruction is currently enabled and available for use.","type":"boolean","default":true},"created_at":{"description":"Timestamp when the instruction was created.","type":"string","format":"date-time"},"updated_at":{"description":"Timestamp when the instruction was last updated.","type":"string","format":"date-time"}},"required":["id","type","name","template_type","template","version","enabled"],"x-vectaraParents":["Instruction"],"title":"InitialInstruction"}}},"oneOf":[{"description":"An initial instruction that provides guidance to the agent before user messages.","type":"object","properties":{"id":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"},"type":{"description":"The type of instruction.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"version":{"description":"The version identifier for this instruction. This is automatically incremented when the instruction is updated.","type":"integer","minimum":1,"example":1},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true},"enabled":{"description":"Whether the instruction is currently enabled and available for use.","type":"boolean","default":true},"created_at":{"description":"Timestamp when the instruction was created.","type":"string","format":"date-time"},"updated_at":{"description":"Timestamp when the instruction was last updated.","type":"string","format":"date-time"}},"required":["id","type","name","template_type","template","version","enabled"],"x-vectaraParents":["Instruction"],"title":"InitialInstruction"}],"title":"Instruction"}}}},"400":{"description":"Instruction update request was malformed or contains invalid content.","content":{"application/json":{"schema":{"description":"Error returned when a request contains invalid parameters or violates schema validation.","type":"object","properties":{"field_errors":{"description":"The errors that relate to specific fields in the request.","type":"object","additionalProperties":{"type":"string"}},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"BadRequestError"}}}},"403":{"description":"Permissions do not allow updating this instruction.","content":{"application/json":{"schema":{"description":"A general error response with an error code and message.","type":"object","properties":{"messages":{"description":"The messages describing why the error occurred.","type":"array","items":{"title":"message","type":"string","example":"Internal server error."}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"Error"}}}},"404":{"description":"Instruction not found.","content":{"application/json":{"schema":{"description":"Error returned when a requested resource does not exist.","type":"object","properties":{"id":{"description":"The ID cannot be found.","type":"string"},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"NotFoundError"}}}}}}
>
  
</StatusCodes>


      
