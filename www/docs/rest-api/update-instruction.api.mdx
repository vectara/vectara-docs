---
id: update-instruction
title: "Update instruction"
description: "Update an existing instruction's template, metadata, and configuration. Updated templates may include Velocity variables. Each update creates a new version, allowing agents to continue using existing versions until explicitly changed."
sidebar_label: "Update instruction"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "patch api-method"
info_path: docs/rest-api/vectara-rest-api-v-2
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Update instruction"}
>
</Heading>

<MethodEndpoint
  method={"patch"}
  path={"/v2/instructions/{instruction_id}"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Update an existing instruction's template, metadata, and configuration. Updated templates may include Velocity variables such as `\$tools` or metadata references. Each update creates a new version, allowing agents to continue using existing versions until explicitly changed.

::info Version Management
Agents referencing a specific version continue to use it until updated. Agents without a pinned version always use the latest.
:::

## Disable an instruction

This endpoint can also be used to disable an instruction without deleting it.

:::warning
Disabling an instruction prevents it from being added to new agents, but agents already using it continue to operate normally.
:::


<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"in":"header","name":"Request-Timeout","description":"The API will make a best effort to complete the request in the specified seconds or time out.","schema":{"type":"integer","minimum":1},"required":false},{"in":"header","name":"Request-Timeout-Millis","description":"The API will make a best effort to complete the request in the specified milliseconds or time out.","schema":{"type":"integer","minimum":1}},{"in":"path","name":"instruction_id","description":"The unique identifier of the instruction to update.","required":true,"schema":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"required":true,"content":{"application/json":{"schema":{"description":"Request to update an instruction. Currently only initial instructions are supported.","discriminator":{"propertyName":"type","mapping":{"initial":{"description":"Request object for updating an existing initial instruction.","type":"object","properties":{"type":{"description":"The type of instruction to update.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string","example":"Enhanced initial context and guidelines for customer support interactions"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true,"example":{"version":"1.1.0","author":"support-team","last_reviewed":"2024-01-15"}},"enabled":{"description":"Whether the instruction is enabled.","type":"boolean","example":true}},"required":["type"],"x-vectaraParents":["UpdateInstructionRequest"],"title":"UpdateInitialInstructionRequest"}}},"oneOf":[{"description":"Request object for updating an existing initial instruction.","type":"object","properties":{"type":{"description":"The type of instruction to update.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string","example":"Enhanced initial context and guidelines for customer support interactions"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true,"example":{"version":"1.1.0","author":"support-team","last_reviewed":"2024-01-15"}},"enabled":{"description":"Whether the instruction is enabled.","type":"boolean","example":true}},"required":["type"],"x-vectaraParents":["UpdateInstructionRequest"],"title":"UpdateInitialInstructionRequest"}],"title":"UpdateInstructionRequest"}}}}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The instruction has been updated successfully.","content":{"application/json":{"schema":{"description":"An instruction that guides agent behavior.","discriminator":{"propertyName":"type","mapping":{"initial":{"description":"An initial instruction that provides guidance to the agent before user messages.","type":"object","properties":{"id":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"},"type":{"description":"The type of instruction.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"version":{"description":"The version identifier for this instruction. This is automatically incremented when the instruction is updated.","type":"integer","minimum":1,"example":1},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true},"enabled":{"description":"Whether the instruction is currently enabled and available for use.","type":"boolean","default":true},"created_at":{"description":"Timestamp when the instruction was created.","type":"string","format":"date-time"},"updated_at":{"description":"Timestamp when the instruction was last updated.","type":"string","format":"date-time"}},"required":["id","type","name","template_type","template","version","enabled"],"x-vectaraParents":["Instruction"],"title":"InitialInstruction"}}},"oneOf":[{"description":"An initial instruction that provides guidance to the agent before user messages.","type":"object","properties":{"id":{"description":"The unique identifier for an instruction.","type":"string","pattern":"ins_[0-9a-zA-Z_-]+$","example":"ins_customer_support_init","title":"InstructionId"},"type":{"description":"The type of instruction.","type":"string","default":"initial","example":"initial"},"name":{"description":"The human-readable name of an instruction.","type":"string","minLength":1,"maxLength":50,"example":"Customer Support Initial Instruction","title":"InstructionName"},"description":{"description":"A detailed description of what this instruction does.","type":"string"},"template_type":{"description":"The templating engine used for instructions.","type":"string","enum":["velocity"],"default":"velocity","example":"velocity","title":"TemplateType"},"template":{"description":"The instruction template content using the specified template engine.\n\nAvailable Velocity variables:\n- `$agent.name` - Agent name\n- `$agent.key` - Agent key\n- `$agent.metadata` - Agent metadata map\n- `$session.key` - Session key\n- `$session.metadata` - Session metadata map (includes user-provided context from test/runtime)\n- `$currentDate` - Current date/time in ISO 8601 format (e.g., \"2025-10-24T15:30:45Z\")\n- `$tools` - List of tool maps, each with `name` and `description` fields\n\nExample: `You are a helpful customer support agent. Agent: $agent.name. Today is $currentDate. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end`\n","type":"string","example":"You are an expert customer support agent for $agent.name. Available tools: #foreach($tool in $tools)${tool.name}#if($foreach.hasNext), #end#end","title":"InstructionTemplate"},"version":{"description":"The version identifier for this instruction. This is automatically incremented when the instruction is updated.","type":"integer","minimum":1,"example":1},"metadata":{"description":"Arbitrary metadata associated with the instruction.","type":"object","additionalProperties":true},"enabled":{"description":"Whether the instruction is currently enabled and available for use.","type":"boolean","default":true},"created_at":{"description":"Timestamp when the instruction was created.","type":"string","format":"date-time"},"updated_at":{"description":"Timestamp when the instruction was last updated.","type":"string","format":"date-time"}},"required":["id","type","name","template_type","template","version","enabled"],"x-vectaraParents":["Instruction"],"title":"InitialInstruction"}],"title":"Instruction"}}}},"400":{"description":"Instruction update request was malformed or contains invalid content.","content":{"application/json":{"schema":{"description":"Error returned when a request contains invalid parameters or violates schema validation.","type":"object","properties":{"field_errors":{"description":"The errors that relate to specific fields in the request.","type":"object","additionalProperties":{"type":"string"}},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"BadRequestError"}}}},"403":{"description":"Permissions do not allow updating this instruction.","content":{"application/json":{"schema":{"description":"A general error response with an error code and message.","type":"object","properties":{"messages":{"description":"The messages describing why the error occurred.","type":"array","items":{"title":"message","type":"string","example":"Internal server error."}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"Error"}}}},"404":{"description":"Instruction not found.","content":{"application/json":{"schema":{"description":"Error returned when a requested resource does not exist.","type":"object","properties":{"id":{"description":"The ID cannot be found.","type":"string"},"messages":{"type":"array","items":{"title":"message","type":"string"}},"request_id":{"description":"The ID of the request that can be used to help Vectara support debug what went wrong.","type":"string"}},"title":"NotFoundError"}}}}}}
>
  
</StatusCodes>


      
