---
id: api-key-management
title: Create and Use API Keys
sidebar_label: Create and Use API Keys
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import {Config} from '@site/docs/definitions.md';
import {vars} from '@site/static/variables.json';

API Keys allow controlled, anonymous access to several administrative tasks, 
indexing your data, and running semantic searches on your corporaâ€”handy for 
Platform Admins setting up systems or App Developers integrating public-facing 
websites. This greatly simplifies integration from public-facing systems like 
websites.

Selecting the wrong key type, or using it incorrectly, can result in errors 
or expose your system to unnecessary risk, a concern for Dev Team Leads 
overseeing secure workflows. If a key is compromised, you can quickly revoke 
the key and replace it in minutes.


:::caution Note
If you create a new corpus, generate a new Index and/or Query API keys. 
Existing keys are bound to their original corpus, a common oversight for 
Developers.
:::

This guide helps you:
- Select the right key type for your use case, whether admin or app-focused
- Avoid permission errors tied to scoping or misuse
- Secure your credentials properly

## Prerequisites

- Access to the [Vectara Console](https://console.vectara.com)
- Have at least one corpus
- Admin or Indexing privileges on the corpus

## API key types and recommended usage

| API Key Type      | Key Prefix | Allowed Operations                  | Scope           | Recommended Usage                     |
|-------------------|------------|-------------------------------------|------------------|----------------------------------------|
| Personal Key      | `zut_`     | All user-level operations           | Account-wide     | Platform Admin tasks, Developers for testing, internal scripts |
| Query Key         | `zqt_`     | Read-only search                    | Corpus-specific  | App Developers for public-facing search, front-end apps   |
| Index Key         | `zwt_`     | Index + query                       | Corpus-specific  | ML Engineers for ingestion, App Developers for server-side testing       |

## Best Practices

- âœ… Use unique keys per use case or microservice
- âœ… Apply the **principle of least privilege**
- ðŸ”„ Rotate API keys periodically and revoke unused ones
- ðŸ”’ Never embed Personal or Index keys in client-side code. Store them on your 
  server instead.

### Personal API key

The Personal API Key helps developers in early stages of exploration and 
prototyping with Vectara, or Platform Admins setting up initial configurations. 
This method provides a straightforward getting started experience for 
integrating accounts with external applications without the complexity of OAuth 
authentication. You can use the Personal API Key when putting together a quick 
prototype, or if you are working on an integration that does not yet support 
OAuth 2.0.

The Personal API Key enables most administrative tasks including creating, 
deleting, and listing corpora, managing API keys for accessible corpora, 
reading usage data, updating corpora filters, executing queries, and indexing.

You cannot use a Personal API Key to delete an account, validate a registration, 
transfer account ownership, or access billing data.

:::caution
A Personal API Key inherits the permissions of its associated user account. 
For example, a key generated by a billing admin will **only** possess 
billing admin-related permissions. Because of their broad access, treat 
Personal API Keys with the same caution as passwords.
:::

### Query API keys

Query API keys are recommended for read-only querying operations and are 
designed for Developers embedding in code that runs in potentially insecure 
environments like web browsers or mobile apps. Query API Keys provide the 
least amount of risk because they have a limited scope and do not modify 
account data.

### Index API keys

Index API Keys offer a practical solution for Developers and ML Engineers 
needing read and write access during development and testing phases. Because 
they also provide write access, Index API Keys are more powerful than Query 
API Keys and should be treated like passwords and used with caution in 
production environments.

:::important

Account owners are responsible for charges incurred through anonymous access to
your account with any of these API keys.

:::

:::warning

:lock: Always keep your API Keys and OAuth tokens private. Do not share them 
through email, Slack, Discord, forums, or other public channels because it 
can lead to unauthorized access. Treat these keys with the same 
confidentiality as your personal credentials. 

:::

## Create an API key

You can easily create a [Personal API key](/docs/console-ui/personal-api-key) or 
an [Index or Query API Key](/docs/console-ui/index-and-query-api-keys), 
and then simply embed the API key and directly pass it to <Config v="names.product"/> when 
issuing requests. 

## Use an API key

To use a Personal, Index, or Query API key, pass it using the `x-api-key` 
header request.

<Tabs
  defaultValue="js"
  values={[
    { label: 'JavaScript', value: 'js', },
    { label: 'Python', value: 'py', },
    { label: 'cURL', value: 'curl', },
  ]
}>
<TabItem value="py">
<pre>
{`
api_key_header = {
    "x-api-key": API_KEY
}
 
data_dict = {
    "query": [
        {
         query: "What is the meaning of life?",
           search: {
            corpora: [{ corpus_key: corpus_key }],
            offset: 0,
            limit: 10,
        },
                }
            ]
        }
    ]
}
payload = json.dumps(data_dict)
response = requests.post(
    "https://${vars['domains.rest.serving']}/v1/query",
    data=payload,
    verify=True,
    headers=api_key_header)
`}
</pre>

</TabItem>
<TabItem value="js">

<pre>
{`
fetch("https://${vars['domains.rest.serving']}:443/v2/query", {
  headers: {
    "Content-Type": "application/json",
    "x-api-key": api_key,
  },
  body: JSON.stringify({
    query: [
      {
        query: "What is the meaning of life?",
        search: {
          corpora: [{ corpus_key: corpus_key }],
          offset: 0,
          limit: 10,
      },
    ],
  }),
  method: "post",
})
  .then((res) => res.json())
  .then((data) => console.log(data))
  .catch((error) => console.log(error));
`}
</pre>
</TabItem>
<TabItem value="curl">
<pre>
{`
curl -X POST \\
  -H "x-api-key: \${API_KEY}" \\
  -H "customer-id: \${CUSTOMER_ID}" \\
  https://${vars['domains.rest.serving']}:443/v1/query \\
  -d @- <<END;
  {
    "query": [
      { "query": "What is the meaning of life?",
         search: {
          corpora: [{ corpus_key: corpus_key }],
          offset: 0,
          limit: 10,
      }
    ]
  }
END
`}
</pre>

</TabItem>
</Tabs>

## Common issues and how to resolve them
| Issue                            | Cause                                      | Fix                                               |
|----------------------------------|--------------------------------------------|----------------------------------------------------|
| 403: Permission Denied           | Key not scoped to corpus                   | Recreate key with correct `corpus_key`             |
| 401: Unauthorized                | Invalid or missing key in header           | Ensure `x-api-key` is correctly included           |
| Indexing fails with Query key   | Used wrong key type                        | Use Index (`zwt_`) or Personal (`zut_`) key        |
| Personal key used in browser    | Security vulnerability                     | Use Query key for public search apps               |


## Disable and enable API keys

To temporarily disable access to an API key, begin by visiting the API Keys
screen. Select disable by clicking on the action menu (three dots) of the key
you want to disable.

![API Key Disable](/img/api_key_disable.png)

It will take around a minute for query requests using this key to be blocked.

Once disabled, a key can be reenabled through the action menu. It will take a
minute or two before it can serve query traffic again.

## Delete API kys

A key may be permanently deleted through its action menu. 

:::caution

Once deleted, there is no way to undelete it, and all external systems that
issue queries using the key will be blocked.

:::


## Next Steps

- Assign Corpus Roles
- Use Metadata Filters for Per-User Access

